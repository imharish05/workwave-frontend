import{u,b as d,r as g,y as r,e as h,f as p,j as f,P as m}from"./index-CeBALVdK.js";const x=()=>{const s=u(),e=d();return g.useEffect(()=>{try{const n=window.location.hash.split("?")[1];if(!n)return r.error("Authentication failed"),e("/login",{replace:!0});const t=new URLSearchParams(n),o=t.get("token"),i=t.get("hasRole")==="true",l=t.get("error");if(l)return r.error(l==="authentication_failed"?"Google authentication failed":"Login error"),e("/login",{replace:!0});if(!o)return r.error("No token received"),e("/login",{replace:!0});const a=h(o).user;localStorage.setItem("token",o),s(p({token:o,user:a})),!i||!a.role?(r.info("Please select your role"),e("/set-role",{replace:!0})):(r.success("Welcome back!"),e(`/${a.role}/dashboard`,{replace:!0}))}catch(c){console.error("Google callback error:",c),r.error("Invalid authentication"),localStorage.removeItem("token"),e("/login",{replace:!0})}},[s,e]),f.jsx(m,{})};export{x as default};
